<div class="card-wrapper">
<%=hidden_field_tag :stage_level, params[:stage_level] %>


<div class='card3' style='height:150px;'>
  <h5>스테이지 테마</h5>
  <p>
    
    <% if @stage.mode ==0 %>
      기본 테마
    <% elsif @stage.mode == 1 %>
      자물쇠 테마
    <% elsif @stage.mode == 2 %>
      순서 테마
    <% elsif @stage.mode == 3 %>
      선택지 테마
    <% else %>
      이미지 클릭 테마
    <% end %>
    
    </p>
</div>

<div class='card3' style='height:150px;'>
  <h5>스테이지 제목</h5>
  <p style="word-wrap: break-word;"><%=@stage.title %></p>
</div>

<%= render 'dialog_modal' %>
        

<div class='card5' style='height:auto;'>
  
  <h5>내용</h5>
  <p style="word-wrap: break-word;"><%=@stage.content.html_safe %> </p>
</div>

<div class='card4'>
  
  <h5><i class="far fa-lightbulb">&nbsp;힌트</i></h5>
  <p type="text-area"><%=@stage.hint1%></p>
</div>

<div class='card4'>
  
  <h5><i class="far fa-lightbulb">&nbsp;힌트</i></h5>
  <p><%=@stage.hint2%></p>
</div>

<div class='card4'>
  
  <h5><i class="far fa-lightbulb">&nbsp;힌트</i></h5>
  <p><%=@stage.hint3%></p>
</div>



  <% if @stage.mode!=4 %>
  <div class="card4">
    <h5><i class="fas fa-check">&nbsp;정답</i></h5>
  <p><%=@stage.answer%></p>
  </div>
  <%end%>
  
  <% if @stage.answer2%>
    <div class="card4">
      <h5><i class="fas fa-check">&nbsp;복수정답 1</i></h5>
    <p>&nbsp;<%=@stage.answer2%></p>
    </div>
  <% end %>
  
  
  <% if @stage.answer3%>
    <div class="card4">
      <h5><i class="fas fa-check">&nbsp;복수정답 2</i></h5>
    <p>&nbsp;<%=@stage.answer3%></p>
  <% end %>
    </div>

<!--이미지가 있는 경우에만 -->


<div>
    <div class='form-group'>
        <label>Uploaded Image</label><br/>
        <div class = 'image-wrapper' style = "position: relative;">
          
           <% if @stage.image && @stage.image.url %>
               <%= image_tag @stage.image.url , id: 'img-upload', class: 'img-main'  %>
           <% else %>
               <%= image_tag '' , id: 'img-upload', class: 'img-main hide'  %>
           <% end %>


          <% if @stage.mode==4 %>
             <span id = 'img-border' style = "position:absolute; height: 50px; width:50px;  display:none; pointer-events: none; left: 0px; top: 0px;"></span>
          <% end %>
         
        </div>

    </div> 
</div>
</div>
<br>
<br>


<%if @room.publish_stage_id < @stage.id %>
  <%= link_to "수정하기",  stage_manage_each_path(@room.id,@stage_level, edit_mode: true) , class: 'btn btn-blueblack' %>
  <button class='btn btn-blueblack' data-toggle="modal" data-target="#delete">
   삭제하기
  </button>
  <button class='btn btn-blueblack' data-toggle="modal" data-target="#publish">
    배포하기
  </button>
  
<% end %>

<br>
<br>

<p style="color:red;"><b>[주의] 한 번 배포 후에는 스테이지 수정이 불가능합니다.</b></p>

<br>
<br>
<br>

<script>
$(document).ready(function(){
  
 var img = document.getElementById("img-upload");

img.onload=function(){
<% if @stage.image.url  %>
    drawImageTheme(img);
<% end %>
}


function drawImageTheme(img){
  if(4==<%=@stage.mode%>){
        
        var ansSize = <%=@Ans_img && @Ans_img[2] ? @Ans_img[2] : 0%>*img.width/100;
        var ansX = <%=@Ans_img && @Ans_img[0] ? @Ans_img[0] : 0%>*img.width/100 - ansSize/2;
        var ansY = <%=@Ans_img && @Ans_img[1] ? @Ans_img[1] : 0%>*img.height/100 - ansSize/2;
        document.getElementById('img-border').style.display='inline';
        document.getElementById('img-border').style.width=ansSize;
        document.getElementById('img-border').style.height=ansSize;
        document.getElementById('img-border').style.left=ansX;
        document.getElementById('img-border').style.top=ansY;
    }
}
});
</script>